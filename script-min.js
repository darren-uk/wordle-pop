const NUMBER_OF_GUESSES=6,green="rgb(138, 188, 177)",yellow="rgb(241, 179, 96)";let allWords,commonWords,answer,gameActive=!1,guessesRemaining=6,nextLetter=0,currentGuess=[],menuContainer=document.getElementById("menu-container"),coloredKeys=document.querySelectorAll(".keyboard-button"),notificationBox=document.getElementById("notification-container");function startGame(){guessesRemaining=6,currentGuess=[],nextLetter=0,answer=commonWords[Math.floor(Math.random()*commonWords.length)],initBoard(),gameActive=!0}function initBoard(){let e=document.getElementById("game-board");e.innerHTML="";for(let t=0;t<6;t++){let t=document.createElement("div");t.className="letter-row";for(let e=0;e<5;e++){let e=document.createElement("div");e.className="letter-box",t.appendChild(e)}e.appendChild(t)}let t=document.getElementsByClassName("hidden-button");for(;t.length;)t[0].classList.remove("hidden-button")}function endGame(){gameActive=!1,coloredKeys.forEach((e=>{e.classList.contains("green-text")||e.classList.contains("red-text")||(e.style.backgroundColor="var(--key-background)",e.classList.remove("light-text"))}))}function insertNotification(e,t){const n="6500";let o=document.createElement("div");o.classList.add(e),o.innerHTML=t,o.style.animationName="show",o.style.animationDuration="6500ms",notificationBox.appendChild(o),setTimeout((()=>{notificationBox.removeChild(o)}),n)}function checkGuess(){let e=document.getElementsByClassName("letter-row")[6-guessesRemaining],t="",n=Array.from(answer);for(const e of currentGuess)t+=e;if(5==t.length){if(allWords.includes(t)){for(let t=0;t<5;t++){let o="",a=e.children[t],s=currentGuess[t],r=n.indexOf(currentGuess[t]);-1===r?o="var(--letter-box-filled)":(o=currentGuess[t]===n[t]?green:yellow,n[r]="#"),setTimeout((()=>{applyAnimation(a,"flipInX"),a.style.backgroundColor=o,shadeKeyBoard(s,o),a.classList.add("light-text")}),250*t)}return t===answer?(insertNotification("green-alert","You guessed right! Game over!"),guessesRemaining=0,winner(),statsPanel(),void setTimeout((()=>{menuContainer.classList.remove("menu-hidden"),menuContainer.classList.add("menu-show")}),"3000")):(guessesRemaining-=1,currentGuess=[],nextLetter=0,0===guessesRemaining?(insertNotification("red-alert",`You've run out of guesses ! <br><br>Game Over ! <br><br>The right word was: ${answer}`),loser(),statsPanel(),void setTimeout((()=>{menuContainer.classList.remove("menu-hidden"),menuContainer.classList.add("menu-show")}),"1500")):void 0)}insertNotification("red-alert","word not in list!")}else insertNotification("red-alert","Not enough letters!")}function statsPanel(){let e=localStorage.getItem("wins"),t=localStorage.getItem("loses"),n=localStorage.getItem("max-streak"),o=localStorage.getItem("current-streak"),a=Number(e)+Number(t);null==e&&(e=0),null==t&&(t=0),null==n&&(n=0),null==o&&(o=0);let s=Math.round(Number(e)/a*100);isNaN(s)&&(s=0);const r=`\n\t\t<div class="statscreen">\n\t\t<div class="close-box" id="close-box">X</div>\n\t\t<h2>Wordle<span>pop</span></h2>\n\n\t\t<p>Win % = ${s}</p>\n\t\t<p><span style="color:var(--yellow);">Current streak = ${o}</span></p>\n\t\t<p>Games played = ${a}</p>\n\t\t<p><span style="color:var(--green);">Games won = ${e}</span></P>\n\t\t<p><span style="color:var(--red);">Games Lost = ${t}</span></p>\n\t\t<p>Max streak = ${n}</p>\n\n\t\t<hr>\n\t\t<p class="start-line">Want to try again? <button class="start-button" id="stat-start-button">Start New Game</button></p>\n\t\t</div>\n\t\t`;menuContainer.innerHTML=r;document.getElementById("close-box").addEventListener("click",(()=>{menuContainer.classList.remove("menu-show"),menuContainer.classList.add("menu-hidden")}));document.getElementById("stat-start-button").addEventListener("click",(()=>{menuContainer.classList.remove("menu-show"),menuContainer.classList.add("menu-hidden"),endGame(),startGame()}))}function winner(){let e=localStorage.getItem("wins");e||(e=0),e=+e+1,localStorage.setItem("wins",e),setCurrentStreak()}function loser(){let e=localStorage.getItem("loses");e||(e=0),e=+e+1,localStorage.setItem("loses",e),localStorage.setItem("current-streak",0)}function setCurrentStreak(){let e=localStorage.getItem("current-streak");e||(e=0),e=+e+1,localStorage.setItem("current-streak",e);let t=localStorage.getItem("max-streak");(!t||t<e)&&localStorage.setItem("max-streak",e)}function insertLetter(e){if(!gameActive||5===nextLetter)return;let t=document.getElementsByClassName("letter-row")[6-guessesRemaining].children[nextLetter];applyAnimation(t,"pulse"),t.textContent=e,t.classList.add("filled-box"),currentGuess.push(e),nextLetter+=1}function deleteLetter(){let e=document.getElementsByClassName("letter-row")[6-guessesRemaining].children[nextLetter-1];e.textContent="",e.classList.remove("filled-box"),currentGuess.pop(),nextLetter-=1}function shadeKeyBoard(e,t){function n(){let t="#"+e,n=document.querySelector(t).getBoundingClientRect(),o=Math.floor(n.x)+10,a=Math.floor(n.y)+20;new mojs.Burst({left:o,top:a,radius:{0:100},count:5,opacity:{1:0},children:{shape:"rect",fill:"#f23884",radius:10,rotate:{0:90},duration:3e3}}).replay()}for(const o of document.getElementsByClassName("keyboard-button"))if(o.textContent===e){let e=o.style.backgroundColor;if(e===green||e===yellow&&t!==green)return void n();o.style.backgroundColor=t,t==green||t==yellow?(o.classList.add("light-text"),n()):(o.classList.add("hidden-button"),n());break}}function applyAnimation(e,t,n="0.3s"){e.style.animation=`${t} ${n}`,e.addEventListener("animationend",(()=>{e.style.animation=""}))}function handleKeyboardClick(e){const t=e.target;if(!t.classList.contains("keyboard-button"))return;let n=t.textContent;"Del"===n&&(n="Backspace"),document.dispatchEvent(new KeyboardEvent("keyup",{key:n}))}function handleKeyUp(e){if(0===guessesRemaining)return;let t=String(e.key);if("Backspace"===t&&0!==nextLetter)return void deleteLetter();if("Enter"===t)return void checkGuess();let n=t.match(/[a-z]/gi);n&&1===n.length&&insertLetter(t)}function handleStatButtonClick(){menuContainer.classList.remove("menu-hidden"),menuContainer.classList.add("menu-show")}function handleStartButtonClick(){menuContainer.classList.remove("menu-show"),menuContainer.classList.add("menu-hidden"),endGame(),startGame()}statsPanel(),document.getElementById("keyboard-cont").addEventListener("click",handleKeyboardClick),document.addEventListener("keyup",handleKeyUp);const statButton=document.querySelector("#stat-button");statButton.addEventListener("click",handleStatButtonClick);let startButton=document.getElementById("start-button");startButton&&startButton.addEventListener("click",handleStartButtonClick);const toggleSwitch=document.querySelector('.theme-switch input[type="checkbox"]');function switchTheme(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}toggleSwitch.addEventListener("change",switchTheme,!1);const currentTheme=localStorage.getItem("theme")?localStorage.getItem("theme"):null;currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"dark"===currentTheme&&(toggleSwitch.checked=!0)),fetch("words.json").then((e=>e.json())).then((e=>{allWords=e.all,commonWords=e.common})).catch((e=>{document.querySelector("#error-box").innerText="Please try again later (error connecting with our server)"}));